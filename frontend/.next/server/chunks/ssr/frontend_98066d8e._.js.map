{"version":3,"sources":["turbopack:///[project]/frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","turbopack:///[project]/frontend/src/lib/api.ts","turbopack:///[project]/frontend/src/app/auth/login/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","// lib/api.ts\r\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000';\r\n\r\ntype RequestMethod = 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';\r\n\r\ninterface FetchOptions extends RequestInit {\r\n    token?: string;\r\n}\r\n\r\nclass APIClient {\r\n    private static async request<T>(endpoint: string, method: RequestMethod, body?: any, token?: string): Promise<T> {\r\n        const headers: HeadersInit = {\r\n            'Content-Type': 'application/json',\r\n        };\r\n\r\n        if (token) {\r\n            headers['Authorization'] = `Bearer ${token}`;\r\n        }\r\n\r\n        const config: RequestInit = {\r\n            method,\r\n            headers,\r\n        };\r\n\r\n        if (body) {\r\n            config.body = JSON.stringify(body);\r\n        }\r\n\r\n        try {\r\n            const response = await fetch(`${API_URL}${endpoint}`, config);\r\n\r\n            if (response.status === 401) {\r\n                // Handle unauthorized access (e.g., clear token and redirect)\r\n                // For now, we'll throw, and the caller (AuthContext) can handle it.\r\n                throw new Error('Unauthorized');\r\n            }\r\n\r\n            if (!response.ok) {\r\n                let errorMessage = 'An error occurred';\r\n                try {\r\n                    const errorData = await response.json();\r\n                    errorMessage = errorData.detail || errorData.message || errorMessage;\r\n                } catch (e) {\r\n                    // Response might not be JSON\r\n                    errorMessage = response.statusText;\r\n                }\r\n                throw new Error(errorMessage);\r\n            }\r\n\r\n            // Handle 204 No Content\r\n            if (response.status === 204) {\r\n                return {} as T;\r\n            }\r\n\r\n            return await response.json();\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    static get<T>(endpoint: string, token?: string) {\r\n        return this.request<T>(endpoint, 'GET', undefined, token);\r\n    }\r\n\r\n    static post<T>(endpoint: string, body: any, token?: string) {\r\n        return this.request<T>(endpoint, 'POST', body, token);\r\n    }\r\n\r\n    static put<T>(endpoint: string, body: any, token?: string) {\r\n        return this.request<T>(endpoint, 'PUT', body, token);\r\n    }\r\n\r\n    static patch<T>(endpoint: string, body: any, token?: string) {\r\n        return this.request<T>(endpoint, 'PATCH', body, token);\r\n    }\r\n\r\n    static delete<T>(endpoint: string, token?: string) {\r\n        return this.request<T>(endpoint, 'DELETE', undefined, token);\r\n    }\r\n}\r\n\r\nexport default APIClient;\r\n","\"use client\";\nimport React, { useState } from 'react';\nimport { useAuth } from '@/context/AuthContext';\nimport APIClient from '@/lib/api';\nimport Link from 'next/link';\n\n\nexport default function LoginPage() {\n  const { login } = useAuth();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    try {\n      const res = await APIClient.post<any>('/auth/login', { email, password });\n      // The contract says: data: { access_token: \"...\", token_type: \"bearer\" }\n      // We need user info too. The contract for login doesn't return user info.\n      // We might need to fetch me, or maybe the plan/contract implies we decode it?\n      // Wait, the plan says \"Connect to API.auth.login\".\n      // Contract: Login returns access_token.\n      // Problem: AuthProvider expects User object.\n      // Solution: Parse JWT if it contains user info, OR fetch /me if exists.\n      // Contract doesn't show /me or user info in login response.\n      // Let's check api contracts again or assume we can get it.\n      // For now, I'll use a placeholder user or try to decode the token if possible (but I don't have a decoder lib).\n      // Actually, let's look at Register contract - it returns user info.\n      // Login contract only returns token.\n      // I will assume for now I can fetch user info or the token has it.\n      // I'll make a subsequent call to getting user tasks to verify? No that returns tasks.\n      // I'll decoding the payload from the token manually (base64 decode).\n\n      const token = res.data.access_token;\n\n      // Simple payload decode\n      let user = { id: 'unknown', email, name: 'User' };\n      try {\n        const payload = JSON.parse(atob(token.split('.')[1]));\n        // specific fields depend on backend JWT structure\n        user = {\n          id: payload.sub || payload.user_id || 'unknown',\n          email: payload.email || email,\n          name: payload.name || 'User'\n        };\n      } catch (e) {\n        console.error(\"Failed to decode token\", e);\n      }\n\n      login(token, user);\n    } catch (err: any) {\n      setError(err.message || 'Login failed');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"w-full\">\n      <div className=\"mb-8\">\n        <h2 className=\"text-3xl font-bold text-slate-900\">Welcome back</h2>\n        <p className=\"text-slate-500 mt-2\">Please enter your details to sign in.</p>\n      </div>\n\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {error && (\n          <div className=\"p-4 rounded-md bg-red-50 text-red-500 text-sm\">\n            {error}\n          </div>\n        )}\n\n        <div className=\"space-y-2\">\n          <label htmlFor=\"email\" className=\"block text-sm font-medium text-slate-700\">Email</label>\n          <input\n            id=\"email\"\n            type=\"email\"\n            required\n            className=\"w-full px-4 py-3 rounded-lg border border-slate-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none transition-all\"\n            placeholder=\"Enter your email\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n          />\n        </div>\n\n        <div className=\"space-y-2\">\n          <label htmlFor=\"password\" className=\"block text-sm font-medium text-slate-700\">Password</label>\n          <input\n            id=\"password\"\n            type=\"password\"\n            required\n            className=\"w-full px-4 py-3 rounded-lg border border-slate-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none transition-all\"\n            placeholder=\"••••••••\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n          />\n        </div>\n\n        <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"w-full py-3 px-4 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-lg shadow-md transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n        >\n          {loading ? 'Signing in...' : 'Sign in'}\n        </button>\n      </form>\n\n      <div className=\"mt-6 text-center text-sm text-slate-500\">\n        Don't have an account?{' '}\n        <Link href=\"/auth/register\" className=\"text-indigo-600 font-semibold hover:text-indigo-500\">\n          Sign up\n        </Link>\n      </div>\n    </div>\n  );\n}"],"names":["module","exports","require","vendored","ReactServerDOMTurbopackClient"],"mappings":"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","ignoreList":[0]}