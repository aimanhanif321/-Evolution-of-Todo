{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/quater4/hachthone-ll/evolution-of-todos/frontend/src/context/AuthContext.tsx"],"sourcesContent":["// src/context/AuthContext.tsx\r\n\"use client\";\r\nimport React, { createContext, useContext, useState, useEffect } from \"react\";\r\nimport { useRouter, usePathname } from \"next/navigation\";\r\n\r\ninterface User {\r\n  id: string;\r\n  email: string;\r\n  name: string;\r\n}\r\n\r\ninterface AuthContextType {\r\n  user: User | null;\r\n  token: string | null;\r\n  login: (token: string, userData: User) => void;\r\n  logout: () => void;\r\n  isAuthenticated: boolean;\r\n  isLoading: boolean;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport const AuthProvider = ({ children }: { children: React.ReactNode }) => {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [token, setToken] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n\r\n  useEffect(() => {\r\n    const storedToken = localStorage.getItem(\"token\");\r\n    const storedUser = localStorage.getItem(\"user\");\r\n    if (storedToken && storedUser) {\r\n      setToken(storedToken);\r\n      setUser(JSON.parse(storedUser));\r\n    }\r\n    setIsLoading(false);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const publicPaths = [\"/auth/login\", \"/auth/register\"];\r\n    if (!isLoading) {\r\n      if (!token && !publicPaths.includes(pathname)) router.push(\"/auth/login\");\r\n      else if (token && publicPaths.includes(pathname)) router.push(\"/dashboard\");\r\n    }\r\n  }, [token, pathname, isLoading, router]);\r\n\r\n  const login = (newToken: string, userData: User) => {\r\n    setToken(newToken);\r\n    setUser(userData);\r\n    localStorage.setItem(\"token\", newToken);\r\n    localStorage.setItem(\"user\", JSON.stringify(userData));\r\n    router.push(\"/dashboard\");\r\n  };\r\n  \r\n\r\n  const logout = () => {\r\n    setToken(null);\r\n    setUser(null);\r\n    localStorage.removeItem(\"token\");\r\n    localStorage.removeItem(\"user\");\r\n    router.push(\"/auth/login\");\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{ user, token, login, logout, isAuthenticated: !!token, isLoading }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) throw new Error(\"useAuth must be used within AuthProvider\");\r\n  return context;\r\n};\r\n"],"names":[],"mappings":"AAAA,8BAA8B;;;;;;;;AAE9B;AACA;;;AAFA;;;AAmBA,MAAM,4BAAc,IAAA,0LAAa,EAA8B;AAExD,MAAM,eAAe,CAAC,EAAE,QAAQ,EAAiC;;IACtE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,qLAAQ,EAAc;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,qLAAQ,EAAgB;IAClD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,qLAAQ,EAAC;IAC3C,MAAM,SAAS,IAAA,8JAAS;IACxB,MAAM,WAAW,IAAA,gKAAW;IAE5B,IAAA,sLAAS;kCAAC;YACR,MAAM,cAAc,aAAa,OAAO,CAAC;YACzC,MAAM,aAAa,aAAa,OAAO,CAAC;YACxC,IAAI,eAAe,YAAY;gBAC7B,SAAS;gBACT,QAAQ,KAAK,KAAK,CAAC;YACrB;YACA,aAAa;QACf;iCAAG,EAAE;IAEL,IAAA,sLAAS;kCAAC;YACR,MAAM,cAAc;gBAAC;gBAAe;aAAiB;YACrD,IAAI,CAAC,WAAW;gBACd,IAAI,CAAC,SAAS,CAAC,YAAY,QAAQ,CAAC,WAAW,OAAO,IAAI,CAAC;qBACtD,IAAI,SAAS,YAAY,QAAQ,CAAC,WAAW,OAAO,IAAI,CAAC;YAChE;QACF;iCAAG;QAAC;QAAO;QAAU;QAAW;KAAO;IAEvC,MAAM,QAAQ,CAAC,UAAkB;QAC/B,SAAS;QACT,QAAQ;QACR,aAAa,OAAO,CAAC,SAAS;QAC9B,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;QAC5C,OAAO,IAAI,CAAC;IACd;IAGA,MAAM,SAAS;QACb,SAAS;QACT,QAAQ;QACR,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;QACxB,OAAO,IAAI,CAAC;IACd;IAEA,qBACE,yMAAC,YAAY,QAAQ;QACnB,OAAO;YAAE;YAAM;YAAO;YAAO;YAAQ,iBAAiB,CAAC,CAAC;YAAO;QAAU;kBAExE;;;;;;AAGP;GAjDa;;QAII,8JAAS;QACP,gKAAW;;;KALjB;AAmDN,MAAM,UAAU;;IACrB,MAAM,UAAU,IAAA,uLAAU,EAAC;IAC3B,IAAI,CAAC,SAAS,MAAM,IAAI,MAAM;IAC9B,OAAO;AACT;IAJa","debugId":null}}]
}